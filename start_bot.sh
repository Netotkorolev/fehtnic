#!/bin/bash

# ะกะบัะธะฟั ะฑะตะทะพะฟะฐัะฝะพะณะพ ะทะฐะฟััะบะฐ ะฑะพัะฐ ะคะตััะะธะบ
# ะฃะฑะธะฒะฐะตั ะฒัะต ัะฐะฑะพัะฐััะธะต ะฟัะพัะตััั ะฑะพัะฐ ะฟะตัะตะด ะทะฐะฟััะบะพะผ ะฝะพะฒะพะณะพ

echo "๐ ะะพะธัะบ ะทะฐะฟััะตะฝะฝัั ะฟัะพัะตััะพะฒ ะฑะพัะฐ..."

# ะะฐัะพะดะธะผ ะฒัะต ะฟัะพัะตััั python3 bot.py ะธ python bot.py
pids=$(ps aux | grep -E "python[3]? bot.py" | grep -v grep | awk '{print $2}')

if [ -z "$pids" ]; then
    echo "โ ะกัะฐััะต ะฟัะพัะตััั ะฑะพัะฐ ะฝะต ะฝะฐะนะดะตะฝั"
else
    echo "๐ ะะฐะนะดะตะฝั ััะฐััะต ะฟัะพัะตััั ะฑะพัะฐ: $pids"
    echo "โ๏ธ  ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ััะฐััะต ะฟัะพัะตััั..."
    
    # ะฃะฑะธะฒะฐะตะผ ะฝะฐะนะดะตะฝะฝัะต ะฟัะพัะตััั
    for pid in $pids; do
        kill -9 $pid 2>/dev/null
        echo "   โ ะัะพัะตัั $pid ะพััะฐะฝะพะฒะปะตะฝ"
    done
    
    sleep 2
    echo "โ ะัะต ััะฐััะต ะฟัะพัะตััั ะพััะฐะฝะพะฒะปะตะฝั"
    echo "โณ ะะถะธะดะฐะฝะธะต ะพัะฒะพะฑะพะถะดะตะฝะธั Telegram API (10 ัะตะบัะฝะด)..."
    sleep 10
fi

# ะะตัะตัะพะดะธะผ ะฒ ะดะธัะตะบัะพัะธั ะฑะพัะฐ
cd "$(dirname "$0")"

echo ""
echo "๐ ะะฐะฟััะบ ะฑะพัะฐ ะคะตััะะธะบ..."
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# ะะฐะฟััะบะฐะตะผ ะฑะพัะฐ
python3 bot.py

